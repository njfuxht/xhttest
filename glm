Application::Application()
{
	// Get screen resolution for fullscreen
	int screen_width = GetSystemMetrics(SM_CXSCREEN);
	int screen_height = GetSystemMetrics(SM_CYSCREEN);

	// Create window in fullscreen mode
	m_Window = std::make_unique<Window>(this);
	m_WindowCreated = m_Window->Create(m_ApplicationTitle, screen_width, screen_height, true);

	// Create renderer
	m_Renderer = std::make_unique<Renderer>(this);
	m_Renderer->Create();

	// Create shader
	m_Shader = std::make_unique<Shader>(m_Renderer.get());
	m_Shader->Load();

	// Create camera
	m_Camera = std::make_unique<Camera>(window_width, window_height);
}



window
bool Window::Create(const std::string& title, int width, int height, bool fullscreen)
{
	HINSTANCE hInstance = GetModuleHandle(NULL);
	std::wstring window_name = ConvertToWString(title);

	// Setup window class
	WNDCLASS wc = {};
	wc.style = CS_VREDRAW | CS_HREDRAW;
	wc.lpfnWndProc = ::MainWndProc;
	wc.hInstance = hInstance;
	wc.hIcon = LoadIcon(0, IDI_APPLICATION);
	wc.hCursor = LoadCursor(0, IDC_ARROW);
	wc.lpszClassName = window_name.c_str();

	if (!RegisterClass(&wc))
	{
		MessageBox(NULL, L"RegisterClass Failed", L"Error", MB_OK);
		throw std::exception();
	}

	// Determine window style based on fullscreen mode
	DWORD window_style = fullscreen ? WS_POPUP : WS_OVERLAPPEDWINDOW;

	// Create window
	m_Hwnd = CreateWindow(wc.lpszClassName, window_name.c_str(), window_style,
		CW_USEDEFAULT, CW_USEDEFAULT, width, height, NULL, NULL, hInstance, this);
	if (m_Hwnd == NULL)
	{
		MessageBox(NULL, L"CreateWindow Failed", L"Error", MB_OK);
		throw std::exception();
	}

	// For fullscreen mode, position window to cover entire screen
	if (fullscreen)
	{
		// Set window position to cover entire screen (0,0 to screen_width, screen_height)
		SetWindowPos(m_Hwnd, HWND_TOP, 0, 0, width, height, SWP_FRAMECHANGED | SWP_SHOWWINDOW);
	}
	else
	{
		// Show window normally for windowed mode
		ShowWindow(m_Hwnd, SW_SHOWNORMAL);
	}

	return true;
}
